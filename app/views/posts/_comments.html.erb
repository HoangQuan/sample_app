<% @comments.each_with_index do |comment, i|%>
<table>
	<tr>
		<td width="25"><%= gravatar_for comment.user, size:25 %></td>
		<td>
			<div class ="comment-content">
				<%= comment.content %>
				<%=link_to "x", comment_path(comment), method: :delete, data: {confirm: "delete"}, class: "delete"%>
				<table class = "table microcomment">
          <div id="tr-microcomment">
        		<%= render "posts/microcomments", comment: comment%>
					</div>
					<tr>
							<div class="microcomment-form<%=i%> microcomment-form" style="display: none">
								<%= form_for comment.microcomments.build , remote: true, url: { controller: "microcomments", action: "create" } do |ff| %>
							    <%= ff.text_field :content, class: "microcomment_content" %>
							    <%= ff.hidden_field :comment_id, value: comment.id %>
							    <%= ff.submit "Send", class: "btn microcomment-submit" %>
							  <% end %>
							</div>
						</tr>
      	</table>
      	<%=link_to "Comment", "#", class: "microcomment_link#{i}"%>
			</div>
		</td>
	</tr>
</table>
<% end %>

<script type="text/javascript">
	<% @comments.each_with_index do |comment, i| %>
  $(document).on("click", ".microcomment_link<%=i%>", function (e){
    e.preventDefault();
    $(".microcomment-form<%=i%>").show();
  })
  <% end %>
</script>